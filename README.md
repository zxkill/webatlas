## WebAtlas — аудит доменов, CMS и уязвимостей с веб-интерфейсом
WebAtlas — масштабируемая платформа для инвентаризации доменов, определения CMS/фреймворков и будущего поиска уязвимостей. Проект включает веб-интерфейс, фоновые задачи Celery и инфраструктуру Docker Compose с PostgreSQL и Redis, а также расширенное логирование и модульную архитектуру аудита.

### Возможности
- Импорт и аудит доменов через скрипты и админку.
- Модульный аудит: доступность сайта, определение CMS, проверка админок, TLS-сертификаты.
- Веб-интерфейс для постановки доменов в очередь, запуска аудита и просмотра отчётов.
- Фоновая обработка через Celery и Redis.
- База данных PostgreSQL для устойчивого хранения результатов аудита.
- Подробное логирование для мониторинга и отладки.
- Валидация конфигурации при запуске для быстрого поиска ошибок.

### Быстрый старт через Docker Compose
1) Соберите и запустите сервисы:
```
docker compose up --build
```
2) Откройте веб-интерфейс на нестандартном порту:
```
http://localhost:8088
```

### Модули аудита
- Все модули включены по умолчанию, но их можно отключать перед запуском аудита.
- Зависимости включаются автоматически: например, если модуль определения CMS подтверждает Bitrix, подключается модуль проверки админки Bitrix.
- Список доступных модулей формируется автоматически и отображается в веб-интерфейсе.

### Действия в админке
- Импортировать домены из файла (путь берётся из `config.yaml`).
- Запустить аудит для всех доменов (с выбором модулей).
- Запустить аудит для конкретного домена (с выбором модулей).
- Запустить аудит для ограниченного списка доменов (limit, с выбором модулей).
- Открыть отчёт по домену.

### Работа со скриптами (локальный запуск)
1) Установка зависимостей:
```
pip install -r requirements.txt
```
2) Импорт доменов из 2ip API:
```
python scripts/import_db.py
```
3) Импорт доменов из файла (по одному домену в строке):
```
python scripts/import_from_file.py
```
4) Аудит доменов (модульный аудит со всеми модулями по умолчанию):
```
python scripts/audit_allowlist.py
```

### Тестирование
1) Запуск тестов:
```
pytest
```

### Переменные окружения для веб-интерфейса
- `DATABASE_URL` — строка подключения к PostgreSQL.
- `REDIS_URL` — базовый адрес Redis.
- `CELERY_BROKER_URL` — брокер Celery (обычно Redis).
- `CELERY_BACKEND_URL` — backend Celery для результатов.
- `APP_HOST` и `APP_PORT` — параметры запуска веб-сервера.
- `APP_CONFIG_PATH` — путь до `config.yaml`, если конфиг расположен не в корне контейнера.

### SEO ключевые слова
Domain audit, CMS detection, vulnerability scanning, web security automation, PostgreSQL, Redis, Celery, Docker Compose, WebAtlas, аудит доменов, проверка CMS, безопасность веб-сайтов, TLS сертификаты.
